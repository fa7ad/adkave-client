/*!
 * jQuery Popup Overlay
 *
 * @version 1.7.6
 * @requires jQuery v1.7.1+
 * @link http://vast-engineering.github.com/jquery-popup-overlay/
 */
!function($){var scrollbarwidth,opentimer,$window=$(window),options={},zindexvalues=[],lastclicked=[],bodymarginright=null,opensuffix="_open",closesuffix="_close",stack=[],transitionsupport=null,iOS=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),methods={_init:function(el){var $el=$(el),options=$el.data("popupoptions");lastclicked[el.id]=!1,zindexvalues[el.id]=0,$el.data("popup-initialized")||($el.attr("data-popup-initialized","true"),methods._initonce(el)),options.autoopen&&setTimeout(function(){methods.show(el,0)},0)},_initonce:function(el){var $wrapper,css,$el=$(el),$body=$("body"),options=$el.data("popupoptions");if(bodymarginright=parseInt($body.css("margin-right"),10),transitionsupport=void 0!==document.body.style.webkitTransition||void 0!==document.body.style.MozTransition||void 0!==document.body.style.msTransition||void 0!==document.body.style.OTransition||void 0!==document.body.style.transition,"tooltip"==options.type&&(options.background=!1,options.scrolllock=!1),options.backgroundactive&&(options.background=!1,options.blur=!1,options.scrolllock=!1),options.scrolllock){var parent,child;"undefined"==typeof scrollbarwidth&&(parent=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),child=parent.children(),scrollbarwidth=child.innerWidth()-child.height(99).innerWidth(),parent.remove())}if($el.attr("id")||$el.attr("id","j-popup-"+parseInt(1e8*Math.random(),10)),$el.addClass("popup_content"),$body.prepend(el),$el.wrap('<div id="'+el.id+'_wrapper" class="popup_wrapper" />'),$wrapper=$("#"+el.id+"_wrapper"),$wrapper.css({opacity:0,visibility:"hidden",position:"absolute"}),iOS&&$wrapper.css("cursor","pointer"),"overlay"==options.type&&$wrapper.css("overflow","auto"),$el.css({opacity:0,visibility:"hidden",display:"inline-block"}),options.setzindex&&!options.autozindex&&$wrapper.css("z-index","100001"),options.outline||$el.css("outline","none"),options.transition&&($el.css("transition",options.transition),$wrapper.css("transition",options.transition)),$el.attr("aria-hidden",!0),options.background&&!$("#"+el.id+"_background").length){$body.prepend('<div id="'+el.id+'_background" class="popup_background"></div>');var $background=$("#"+el.id+"_background");$background.css({opacity:0,visibility:"hidden",backgroundColor:options.color,position:"fixed",top:0,right:0,bottom:0,left:0}),options.setzindex&&!options.autozindex&&$background.css("z-index","100000"),options.transition&&$background.css("transition",options.transition)}"overlay"==options.type&&($el.css({textAlign:"left",position:"relative",verticalAlign:"middle"}),css={position:"fixed",width:"100%",height:"100%",top:0,left:0,textAlign:"center"},options.backgroundactive&&(css.position="relative",css.height="0",css.overflow="visible"),$wrapper.css(css),$wrapper.append('<div class="popup_align" />'),$(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})),$el.attr("role","dialog");var openelement=options.openelement?options.openelement:"."+el.id+opensuffix;$(openelement).each(function(i,item){$(item).attr("data-popup-ordinal",i),item.id||$(item).attr("id","open_"+parseInt(1e8*Math.random(),10))}),$el.attr("aria-labelledby")||$el.attr("aria-label")||$el.attr("aria-labelledby",$(openelement).attr("id")),"hover"==options.action?(options.keepfocus=!1,$(openelement).on("mouseenter",function(){methods.show(el,$(this).data("popup-ordinal"))}),$(openelement).on("mouseleave",function(){methods.hide(el)})):$(document).on("click",openelement,function(event){event.preventDefault();var ord=$(this).data("popup-ordinal");setTimeout(function(){methods.show(el,ord)},0)}),options.closebutton&&methods.addclosebutton(el),options.detach?$el.hide().detach():$wrapper.hide()},show:function(el,ordinal){var $el=$(el);if(!$el.data("popup-visible")){$el.data("popup-initialized")||methods._init(el),$el.attr("data-popup-initialized","true");var $body=$("body"),options=$el.data("popupoptions"),$wrapper=$("#"+el.id+"_wrapper"),$background=$("#"+el.id+"_background");if(callback(el,ordinal,options.beforeopen),lastclicked[el.id]=ordinal,setTimeout(function(){stack.push(el.id)},0),options.autozindex){for(var elements=document.getElementsByTagName("*"),len=elements.length,maxzindex=0,i=0;len>i;i++){var elementzindex=$(elements[i]).css("z-index");"auto"!==elementzindex&&(elementzindex=parseInt(elementzindex,10),elementzindex>maxzindex&&(maxzindex=elementzindex))}zindexvalues[el.id]=maxzindex,options.background&&zindexvalues[el.id]>0&&$("#"+el.id+"_background").css({zIndex:zindexvalues[el.id]+1}),zindexvalues[el.id]>0&&$wrapper.css({zIndex:zindexvalues[el.id]+2})}options.detach?($wrapper.prepend(el),$el.show()):$wrapper.show(),opentimer=setTimeout(function(){$wrapper.css({visibility:"visible",opacity:1}),$("html").addClass("popup_visible").addClass("popup_visible_"+el.id),$wrapper.addClass("popup_wrapper_visible")},20),options.scrolllock&&($body.css("overflow","hidden"),$body.height()>$window.height()&&$body.css("margin-right",bodymarginright+scrollbarwidth)),options.backgroundactive&&$el.css({top:($window.height()-($el.get(0).offsetHeight+parseInt($el.css("margin-top"),10)+parseInt($el.css("margin-bottom"),10)))/2+"px"}),$el.css({visibility:"visible",opacity:1}),options.background&&($background.css({visibility:"visible",opacity:options.opacity}),setTimeout(function(){$background.css({opacity:options.opacity})},0)),$el.data("popup-visible",!0),methods.reposition(el,ordinal),$el.data("focusedelementbeforepopup",document.activeElement),options.keepfocus&&($el.attr("tabindex",-1),setTimeout(function(){"closebutton"===options.focuselement?$("#"+el.id+" ."+el.id+closesuffix+":first").focus():options.focuselement?$(options.focuselement).focus():$el.focus()},options.focusdelay)),$(options.pagecontainer).attr("aria-hidden",!0),$el.attr("aria-hidden",!1),callback(el,ordinal,options.onopen),transitionsupport?$wrapper.one("transitionend",function(){callback(el,ordinal,options.opentransitionend)}):callback(el,ordinal,options.opentransitionend)}},hide:function(el){opentimer&&clearTimeout(opentimer);var $body=$("body"),$el=$(el),options=$el.data("popupoptions"),$wrapper=$("#"+el.id+"_wrapper"),$background=$("#"+el.id+"_background");$el.data("popup-visible",!1),1===stack.length?$("html").removeClass("popup_visible").removeClass("popup_visible_"+el.id):$("html").hasClass("popup_visible_"+el.id)&&$("html").removeClass("popup_visible_"+el.id),stack.pop(),$wrapper.hasClass("popup_wrapper_visible")&&$wrapper.removeClass("popup_wrapper_visible"),options.keepfocus&&setTimeout(function(){$($el.data("focusedelementbeforepopup")).is(":visible")&&$el.data("focusedelementbeforepopup").focus()},0),$wrapper.css({visibility:"hidden",opacity:0}),$el.css({visibility:"hidden",opacity:0}),options.background&&$background.css({visibility:"hidden",opacity:0}),$(options.pagecontainer).attr("aria-hidden",!1),$el.attr("aria-hidden",!0),callback(el,lastclicked[el.id],options.onclose),transitionsupport&&"0s"!==$el.css("transition-duration")?$el.one("transitionend",function(){$el.data("popup-visible")||(options.detach?$el.hide().detach():$wrapper.hide()),options.scrolllock&&setTimeout(function(){$body.css({overflow:"visible","margin-right":bodymarginright})},10),callback(el,lastclicked[el.id],options.closetransitionend)}):(options.detach?$el.hide().detach():$wrapper.hide(),options.scrolllock&&setTimeout(function(){$body.css({overflow:"visible","margin-right":bodymarginright})},10),callback(el,lastclicked[el.id],options.closetransitionend))},toggle:function(el,ordinal){$(el).data("popup-visible")?methods.hide(el):setTimeout(function(){methods.show(el,ordinal)},0)},reposition:function(el,ordinal){{var $el=$(el),options=$el.data("popupoptions"),$wrapper=$("#"+el.id+"_wrapper");$("#"+el.id+"_background")}if(ordinal=ordinal||0,"tooltip"==options.type){$wrapper.css({position:"absolute"});var $tooltipanchor;$tooltipanchor=options.tooltipanchor?$(options.tooltipanchor):options.openelement?$(options.openelement).filter('[data-popup-ordinal="'+ordinal+'"]'):$("."+el.id+opensuffix+'[data-popup-ordinal="'+ordinal+'"]');var linkOffset=$tooltipanchor.offset();"right"==options.horizontal?$wrapper.css("left",linkOffset.left+$tooltipanchor.outerWidth()+options.offsetleft):"leftedge"==options.horizontal?$wrapper.css("left",linkOffset.left+$tooltipanchor.outerWidth()-$tooltipanchor.outerWidth()+options.offsetleft):"left"==options.horizontal?$wrapper.css("right",$window.width()-linkOffset.left-options.offsetleft):"rightedge"==options.horizontal?$wrapper.css("right",$window.width()-linkOffset.left-$tooltipanchor.outerWidth()-options.offsetleft):$wrapper.css("left",linkOffset.left+$tooltipanchor.outerWidth()/2-$el.outerWidth()/2-parseFloat($el.css("marginLeft"))+options.offsetleft),"bottom"==options.vertical?$wrapper.css("top",linkOffset.top+$tooltipanchor.outerHeight()+options.offsettop):"bottomedge"==options.vertical?$wrapper.css("top",linkOffset.top+$tooltipanchor.outerHeight()-$el.outerHeight()+options.offsettop):"top"==options.vertical?$wrapper.css("bottom",$window.height()-linkOffset.top-options.offsettop):"topedge"==options.vertical?$wrapper.css("bottom",$window.height()-linkOffset.top-$el.outerHeight()-options.offsettop):$wrapper.css("top",linkOffset.top+$tooltipanchor.outerHeight()/2-$el.outerHeight()/2-parseFloat($el.css("marginTop"))+options.offsettop)}else"overlay"==options.type&&(options.horizontal?$wrapper.css("text-align",options.horizontal):$wrapper.css("text-align","center"),options.vertical?$el.css("vertical-align",options.vertical):$el.css("vertical-align","middle"))},addclosebutton:function(el){var genericCloseButton;genericCloseButton=$(el).data("popupoptions").closebuttonmarkup?$(options.closebuttonmarkup).addClass(el.id+"_close"):'<button class="popup_close '+el.id+'_close" title="Close" aria-label="Close"><span aria-hidden="true">Ã—</span></button>',$el.data("popup-initialized")&&$el.append(genericCloseButton)}},callback=function(el,ordinal,func){var options=$(el).data("popupoptions"),openelement=options.openelement?options.openelement:"."+el.id+opensuffix,elementclicked=$(openelement+'[data-popup-ordinal="'+ordinal+'"]');"function"==typeof func&&func.call($(el),el,elementclicked)};$(document).on("keydown",function(event){if(stack.length){var elementId=stack[stack.length-1],el=document.getElementById(elementId);$(el).data("popupoptions").escape&&27==event.keyCode&&methods.hide(el)}}),$(document).on("click",function(event){if(stack.length){var elementId=stack[stack.length-1],el=document.getElementById(elementId),closeButton=$(el).data("popupoptions").closeelement?$(el).data("popupoptions").closeelement:"."+el.id+closesuffix;$(event.target).closest(closeButton).length&&(event.preventDefault(),methods.hide(el)),$(el).data("popupoptions").blur&&!$(event.target).closest("#"+elementId).length&&2!==event.which&&$(event.target).is(":visible")&&(methods.hide(el),"overlay"===$(el).data("popupoptions").type&&event.preventDefault())}}),$(document).on("focusin",function(event){if(stack.length){var elementId=stack[stack.length-1],el=document.getElementById(elementId);$(el).data("popupoptions").keepfocus&&(el.contains(event.target)||(event.stopPropagation(),el.focus()))}}),$.fn.popup=function(customoptions){return this.each(function(){if($el=$(this),"object"==typeof customoptions){var opt=$.extend({},$.fn.popup.defaults,customoptions);$el.data("popupoptions",opt),options=$el.data("popupoptions"),methods._init(this)}else"string"==typeof customoptions?($el.data("popupoptions")||($el.data("popupoptions",$.fn.popup.defaults),options=$el.data("popupoptions")),methods[customoptions].call(this,this)):($el.data("popupoptions")||($el.data("popupoptions",$.fn.popup.defaults),options=$el.data("popupoptions")),methods._init(this))})},$.fn.popup.defaults={type:"overlay",autoopen:!1,background:!0,backgroundactive:!1,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:!0,blur:!0,setzindex:!0,autozindex:!1,scrolllock:!1,closebutton:!1,closebuttonmarkup:null,keepfocus:!0,focuselement:null,focusdelay:50,outline:!1,pagecontainer:null,detach:!1,openelement:null,closeelement:null,transition:null,tooltipanchor:null,beforeopen:null,onclose:null,onopen:null,opentransitionend:null,closetransitionend:null}}(jQuery);